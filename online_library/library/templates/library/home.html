{% extends 'library/base.html' %}

{% block content %}
<div class="container mt-4">
    <h2>Welcome to the Online Library</h2>

    <form method="GET" action="{% url 'material_list' %}" class="d-flex">
        <input type="text" name="q" class="form-control me-2" placeholder="Search materials..." value="{{ request.GET.q }}">
        <button type="submit" class="btn btn-primary">Search</button>
    </form>

    <hr>

    <h3>Browse by Category</h3>
    <ul class="list-group list-group-horizontal">
        <li class="list-group-item"><a href="{% url 'material_list' %}?category=Text">Book</a></li>
        <li class="list-group-item"><a href="{% url 'material_list' %}?category=Video">Video</a></li>
        <li class="list-group-item"><a href="{% url 'material_list' %}?category=Audio">Audio</a></li>
        <li class="list-group-item"><a href="{% url 'material_list' %}?category=Software">Software</a></li>
        <li class="list-group-item"><a href="{% url 'material_list' %}?category=Image">Image</a></li>
    </ul>

    <hr>

    <h3>Latest Materials</h3>
    <ul class="list-group">
        {% for material in latest_materials %}
            <li class="list-group-item">
                <a href="{% url 'material_detail' material.id %}">{{ material.title }}</a>
                ({{ material.category }}) - Uploaded on {{ material.upload_date }}
            </li>
        {% empty %}
            <p>No materials available.</p>
        {% endfor %}
    </ul>

    <hr>

    <h3>Top 5 Materials</h3>
    <ul class="list-group">
        {% for material in top_materials %}
            <li class="list-group-item">
                <a href="{% url 'material_detail' material.id %}">{{ material.title }}</a>
                ({{ material.category }}) -
                {% if material.avg_rating %}
                    Average Rating: {{ material.avg_rating|floatformat:1 }}/5 ‚≠ê
                {% else %}
                    No ratings yet
                {% endif %}
            </li>
        {% empty %}
            <p>No top-rated materials available.</p>
        {% endfor %}
    </ul>
</div>
{% endblock %}
